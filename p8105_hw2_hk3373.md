P8105 Homework 2
================
Hyun Kim (hk3373)
2024-10-02

# Problem 1

## Import and tidy NYC transit dataset:

``` r
nyc_transit_df = 
  read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv",
           na = "",
           col_types = cols(
             `Route8` = col_character(),
             `Route9` = col_character(),
             `Route10` = col_character(),
             `Route11` = col_character()
           )) |>
  janitor::clean_names() |>
  select(line:entry, vending, ada) |>
  mutate(entry = 
           case_match(
             entry,
             "YES" ~ TRUE,
             "NO" ~ FALSE),
         entry = as.logical(entry))

str(nyc_transit_df)
```

    ## tibble [1,868 × 19] (S3: tbl_df/tbl/data.frame)
    ##  $ line             : chr [1:1868] "4 Avenue" "4 Avenue" "4 Avenue" "4 Avenue" ...
    ##  $ station_name     : chr [1:1868] "25th St" "25th St" "36th St" "36th St" ...
    ##  $ station_latitude : num [1:1868] 40.7 40.7 40.7 40.7 40.7 ...
    ##  $ station_longitude: num [1:1868] -74 -74 -74 -74 -74 ...
    ##  $ route1           : chr [1:1868] "R" "R" "N" "N" ...
    ##  $ route2           : chr [1:1868] NA NA "R" "R" ...
    ##  $ route3           : chr [1:1868] NA NA NA NA ...
    ##  $ route4           : chr [1:1868] NA NA NA NA ...
    ##  $ route5           : chr [1:1868] NA NA NA NA ...
    ##  $ route6           : chr [1:1868] NA NA NA NA ...
    ##  $ route7           : chr [1:1868] NA NA NA NA ...
    ##  $ route8           : chr [1:1868] NA NA NA NA ...
    ##  $ route9           : chr [1:1868] NA NA NA NA ...
    ##  $ route10          : chr [1:1868] NA NA NA NA ...
    ##  $ route11          : chr [1:1868] NA NA NA NA ...
    ##  $ entrance_type    : chr [1:1868] "Stair" "Stair" "Stair" "Stair" ...
    ##  $ entry            : logi [1:1868] TRUE TRUE TRUE TRUE TRUE TRUE ...
    ##  $ vending          : chr [1:1868] "YES" "YES" "YES" "YES" ...
    ##  $ ada              : logi [1:1868] FALSE FALSE FALSE FALSE FALSE FALSE ...

The dataset includes transit line, station name, latitude, longitude,
routes (from 1 to 11), entrance type, entry, vending and ada compliance.
The station’s latitude and longitude are numeric variables, while entry
and ada compliance are logical variables. The other variables, such as
line, station name, entrance type, vending and route1 to route11 are
character variables.

For the data cleaning process, NA values were defined when reading the
csv file, and route8 to route11 were converted to character variables
for consistency since route1 to route7 were character variables. The
dataset has a dimension of 1868 rows and 19 columns. The dataset is not
tidy since route number should be a variable including the values of all
routes, which can be resolved using the pivot_longer function.

### How many distinct stations are there?

``` r
num_station = nrow(nyc_transit_df |> 
                      distinct(line, station_name))
```

There are 465 distinct stations.

### How many stations are ADA compliant?

``` r
num_ada = nrow(nyc_transit_df |> 
                 filter(ada==TRUE) |> 
                 distinct(line, station_name))
```

84 stations are ADA compliant.

### What proportion of station entrances / exits without vending allow entrance?

``` r
prop_entrance = round(
  nrow(nyc_transit_df |> 
          filter(vending == "NO") |> 
          filter(entry == TRUE)) / 
     nrow(nyc_transit_df |>
            filter(vending == "NO")) * 100, 2)
```

37.7 percent of station entrances/exits without vending allow entrance.

## Reformat transit data:

``` r
nyc_transit_df = nyc_transit_df |>
  pivot_longer(
    route1:route11,
    names_to = "route_number",
    values_to = "route_name"
  ) |>
  relocate(route_number, route_name) |>
  drop_na()
```

### How many distinct stations serve the A train?

``` r
num_stations_A = nrow(nyc_transit_df |> 
                          filter(route_name == "A") |> 
                          distinct(line, station_name))
```

60 distinct stations serve the A train.

### Of the stations that serve the A train, how many are ADA compliant?

``` r
num_ada_A = nrow(nyc_transit_df |> 
                         filter(route_name == "A") |> 
                         filter(ada == TRUE) |> distinct(line, station_name))
```

17 of the stations that serve the A train are ADA compliant.

# Problem 2

## Import, tidy and merge Trash Wheel datasets:

``` r
mr_trash_df = 
  readxl::read_excel(
    "./data/202409 Trash Wheel Collection Data.xlsx",
    sheet = "Mr. Trash Wheel",
    range = "A2:N653",
    na = "") |>
  janitor::clean_names() |>
  mutate(
    year = as.numeric(year),
    sports_balls = as.integer(round(sports_balls)),
    trash_wheel = "Mr.") |>
  relocate(trash_wheel)

prof_trash_df = 
  readxl::read_excel(
    "./data/202409 Trash Wheel Collection Data.xlsx",
    sheet = "Professor Trash Wheel",
    range = "A2:M120",
    na = "") |>
  janitor::clean_names() |>
  mutate(
    year = as.numeric(year),
    sports_balls = NA,
    trash_wheel = "Professor") |>
  relocate(trash_wheel)

gwynnda_trash_df = 
  readxl::read_excel(
    "./data/202409 Trash Wheel Collection Data.xlsx",
    sheet = "Gwynnda Trash Wheel",
    range = "A2:L265") |>
  janitor::clean_names() |>
  mutate(
    year = as.numeric(year),
    sports_balls = NA,
    glass_bottles = NA,
    trash_wheel = "Gwynnda") |>
  relocate(trash_wheel)

merged_trash_df = rbind(mr_trash_df, prof_trash_df, gwynnda_trash_df)
str(merged_trash_df)
```

    ## tibble [1,032 × 15] (S3: tbl_df/tbl/data.frame)
    ##  $ trash_wheel       : chr [1:1032] "Mr." "Mr." "Mr." "Mr." ...
    ##  $ dumpster          : num [1:1032] 1 2 3 4 5 6 7 8 9 10 ...
    ##  $ month             : chr [1:1032] "May" "May" "May" "May" ...
    ##  $ year              : num [1:1032] 2014 2014 2014 2014 2014 ...
    ##  $ date              : POSIXct[1:1032], format: "2014-05-16" "2014-05-16" ...
    ##  $ weight_tons       : num [1:1032] 4.31 2.74 3.45 3.1 4.06 2.71 1.91 3.7 2.52 3.76 ...
    ##  $ volume_cubic_yards: num [1:1032] 18 13 15 15 18 13 8 16 14 18 ...
    ##  $ plastic_bottles   : num [1:1032] 1450 1120 2450 2380 980 1430 910 3580 2400 1340 ...
    ##  $ polystyrene       : num [1:1032] 1820 1030 3100 2730 870 2140 1090 4310 2790 1730 ...
    ##  $ cigarette_butts   : num [1:1032] 126000 91000 105000 100000 120000 90000 56000 112000 98000 130000 ...
    ##  $ glass_bottles     : num [1:1032] 72 42 50 52 72 46 32 58 49 75 ...
    ##  $ plastic_bags      : num [1:1032] 584 496 1080 896 368 ...
    ##  $ wrappers          : num [1:1032] 1162 874 2032 1971 753 ...
    ##  $ sports_balls      : int [1:1032] 7 5 6 6 7 5 3 6 6 7 ...
    ##  $ homes_powered     : num [1:1032] 0 0 0 0 0 0 0 0 0 0 ...

The dataset has 1032 rows and 15 columns. Important variables include
the weight (tons) and volume (cubic yards) of trash collected, date and
homes powered. The dataset also includes the types and respective
quantities of trash collected, such as plastic bottles, polystyrene,
cigarette butts, glass bottles, plastic bags, wrappers and sports balls.

The total trash collected by Mr. Trash Wheel, Professor Trash Wheel and
Gwynnda is 3135.47 tons and 1.5559^{4} cubic yards, powering a total of
4.4822^{4} homes.

### What was the total weight of trash collected by Professor Trash Wheel?

``` r
prof_total_trash = sum(merged_trash_df |> 
                              filter(trash_wheel == "Professor") |> 
                              pull(weight_tons))
```

Professor Trash Wheel collected 246.74 tons of trash in total.

### What was the total number of cigarette butts collected by Gwynnda in June of 2022?

``` r
gwynnda_june_cigs = sum(merged_trash_df |> 
                           filter(trash_wheel == "Gwynnda") |> 
                           filter(month == "June") |> 
                           filter(year == 2022) |> 
                           pull(cigarette_butts))
```

Gwynnda collected 1.812^{4} cigarette butts in June of 2022.
